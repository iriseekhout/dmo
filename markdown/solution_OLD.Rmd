---
title: "solutions_OLD"
author: "dr. Iris Eekhout"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

**a. Evaluate the missing data mechanism for the boys data with univariate tests. What are your conclusions?**

Evaluation using T-tests for continuous variables and the Chi-square for categorical variables.

First create the missing data indicators for each variable with missing data.
```{r}
library(dplyr)
boysm <- boys %>%
  #create missing data indicators
  mutate(Rhgt = is.na(hgt),
         Rwgt = is.na(wgt),
         Rbmi = is.na(bmi),
         Rhc = is.na(hc),
         Rgen = is.na(gen),
         Rphb = is.na(phb), 
         Rtv = is.na(tv),
         Rreg = is.na(reg))

```

Do a T-test for each missing data indicator with the continuous variables and a chi square test for the categorical variables.

* Missing data in hgt seem to be related to age, wgt and hc; the group with missing heights are younger, lower weights and smaller hc.
* Nothing found for missing data in wgt
* Missing data in bmi seem to be related to age and hc; the group with missing bmi are younger and have smaller head circumference. 
* Missing data in hc seem to be related to age, hgt, wgt, bmi and reg; the group with missing hc are older, have higher heights, weights and bmi. 
* Missing data in gen are related to age, hgt, wgt, bmi, hc and reg; the group with missing gen are younger, and have smaller heights, weights, bmi and hc. 
* Missing data in phb are related to age, hgt, wgt, bmi, hc and reg; the group with missing gen are younger, and have smaller heights, weights, bmi and hc. 
* Missing data in tv are related to age, hgt, wgt, bmi and hc; the group with missing gen are younger, and have smaller heights, weights, bmi and hc. 
* Missing data in reg are related to age, wgt and bmi; the group with missing gen are younger, and have smaller weights and bmi. 

Based on the univariate analyses we may conclude that the missing data are not Missing Completely at Random (not-MCAR). There are other measured variable related to the probability of missing data. 

**Notes: we are performing a lot of tests here, so we may want to adjust for multiple testing; Some of the chi-square tests do not have sufficient observations in the cells so be careful about conclusions for these tests; some tests could not be performed because variables are always missing at the same time.**

```{r}
# Univariate tests for hgt
t.test(age ~ Rhgt, data = boysm)
t.test(wgt ~ Rhgt, data = boysm)
#t.test(bmi ~ Rhgt, data = boysm)  ~ cannot be performed, because when hgt is missing, bmi is also missing.
t.test(hc ~ Rhgt, data = boysm)
t.test(tv ~ Rhgt, data = boysm)
chisq.test(boysm$Rhgt, boysm$gen)
chisq.test(boysm$Rhgt, boysm$phb)
chisq.test(boysm$Rhgt, boysm$reg)

# t-tests for wgt
t.test(age ~ Rwgt, data = boysm)
#t.test(hgt ~ Rwgt, data = boysm) ~ cannot be performed not enough observed hgt when wgt is missing.
#t.test(bmi ~ Rwgt, data = boysm) ~ cannot be performed, because when wgt is missing, bmi is also missing. 
t.test(hc ~ Rwgt, data = boysm)
t.test(tv ~ Rwgt, data = boysm)
chisq.test(boysm$Rwgt, boysm$gen, simulate.p.value = TRUE)
chisq.test(boysm$Rwgt, boysm$phb, simulate.p.value = TRUE)
chisq.test(boysm$Rwgt, boysm$reg, simulate.p.value = TRUE)

# t-tests for bmi
t.test(age ~ Rbmi, data = boysm)
#t.test(hgt ~ Rbmi, data = boysm)
#t.test(wgt ~ Rbmi, data = boysm) ~ cannot be performed, because when hgt is missing, bmi is also missing.
t.test(hc ~ Rbmi, data = boysm)
t.test(tv ~ Rbmi, data = boysm)
chisq.test(boysm$Rbmi, boysm$gen)
chisq.test(boysm$Rbmi, boysm$phb)
chisq.test(boysm$Rbmi, boysm$reg)

# t-tests for hc
t.test(age ~ Rhc, data = boysm)
t.test(hgt ~ Rhc, data = boysm)
t.test(wgt ~ Rhc, data = boysm)
t.test(bmi ~ Rhc, data = boysm)#
#t.test(tv ~ Rhc, data = boysm) ~ cannot be performed not enough observed tv when hc is missing.
chisq.test(boysm$Rhc, boysm$gen)
chisq.test(boysm$Rhc, boysm$phb)
chisq.test(boysm$Rhc, boysm$reg)#

# t-tests for gen
t.test(age ~ Rgen, data = boysm)
t.test(hgt ~ Rgen, data = boysm)
t.test(wgt ~ Rgen, data = boysm)
t.test(bmi ~ Rgen, data = boysm)
t.test(hc ~ Rgen, data = boysm)
#t.test(tv ~ Rgen, data = boysm)
#chisq.test(boysm$Rgen, boysm$phb)
chisq.test(boysm$Rgen, boysm$reg)

# t-tests for phb
t.test(age ~ Rphb, data = boysm)
t.test(hgt ~ Rphb, data = boysm)
t.test(wgt ~ Rphb, data = boysm)
t.test(bmi ~ Rphb, data = boysm)
t.test(hc ~ Rphb, data = boysm)
#t.test(tv ~ Rphb, data = boysm)
chisq.test(boysm$Rphb, boysm$gen)
chisq.test(boysm$Rphb, boysm$reg)


# t-tests for tv
t.test(age ~ Rtv, data = boysm)
t.test(hgt ~ Rtv, data = boysm)
t.test(wgt ~ Rtv, data = boysm)
t.test(bmi ~ Rtv, data = boysm)
t.test(hc ~ Rtv, data = boysm)
chisq.test(boysm$Rtv, boysm$gen)
chisq.test(boysm$Rtv, boysm$phb)
chisq.test(boysm$Rtv, boysm$reg)

# t-tests for reg
t.test(age ~ Rreg, data = boysm)
t.test(hgt ~ Rreg, data = boysm)
t.test(wgt ~ Rreg, data = boysm)
t.test(bmi ~ Rreg, data = boysm)
t.test(hc ~ Rreg, data = boysm)
#t.test(tv ~ Rreg, data = boysm)
#chisq.test(boysm$Rreg, boysm$gen)
#chisq.test(boysm$Rreg, boysm$phb)

```



